cc = cli.cc or "gcc"
local arch = cli.arch or "amd64"
local trampoline := $arch/trampoline

return b{
    $ loader: loader.o $trampoline.o
        $cc $input -o $output
    $ loader.o: loader.c
        $cc $input -c -o $output -O2
    $ $trampoline.o: $trampoline.s
        $cc $input -c -o $output
    $ format:VB:
        clang-format -i loader.c

    include("test/build.knit"),
}
